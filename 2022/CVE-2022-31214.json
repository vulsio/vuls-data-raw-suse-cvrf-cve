{
	"document_title": "CVE-2022-31214",
	"document_type": "SUSE CVE",
	"document_publisher": {
		"type": "Vendor",
		"contact_details": "security@suse.de",
		"issuing_authority": "SUSE Security Team"
	},
	"document_tracking": {
		"identification": {
			"id": "SUSE CVE-2022-31214"
		},
		"status": "Interim",
		"version": "1",
		"revision_history": {
			"revision": {
				"number": "6",
				"date": "2023-09-06T23:28:34Z",
				"description": "current"
			}
		},
		"initial_release_date": "2022-06-09T23:46:45Z",
		"current_release_date": "2023-09-06T23:28:34Z",
		"generator": {
			"engine": "cve-database/bin/generate-cvrf-cve.pl",
			"date": "2020-12-27T01:00:00Z"
		}
	},
	"document_notes": [
		{
			"text": "CVE-2022-31214",
			"title": "CVE",
			"type": "Summary"
		},
		{
			"text": "A Privilege Context Switching issue was discovered in join.c in Firejail 0.9.68. By crafting a bogus Firejail container that is accepted by the Firejail setuid-root program as a join target, a local attacker can enter an environment in which the Linux user namespace is still the initial user namespace, the NO_NEW_PRIVS prctl is not activated, and the entered mount namespace is under the attacker's control. In this way, the filesystem layout can be adjusted to gain root privileges through execution of available setuid-root binaries such as su or sudo.",
			"title": "Mitre CVE Description",
			"type": "Description"
		},
		{
			"text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
			"title": "Terms of Use",
			"type": "Legal Disclaimer"
		}
	],
	"document_references": [
		{
			"type": "Self",
			"url": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/Y44WP6HYFSMERMHYQLJJNHIWG34P4MU4/",
			"description": "E-Mail link for openSUSE-SU-2022:10015-1"
		},
		{
			"type": "Self",
			"url": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/BANQSQMV546D7IN75266REGOZOIGQEUH/",
			"description": "E-Mail link for openSUSE-SU-2022:10016-1"
		},
		{
			"type": "Self",
			"url": "https://www.suse.com/support/security/rating/",
			"description": "SUSE Security Ratings"
		}
	],
	"product_tree": {
		"branch": [
			{
				"type": "Product Family",
				"name": "SUSE Package Hub 15 SP3",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Package Hub 15 SP3",
						"full_product_name": {
							"text": "SUSE Package Hub 15 SP3",
							"product_id": "SUSE Package Hub 15 SP3"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Package Hub 15 SP4",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Package Hub 15 SP4",
						"full_product_name": {
							"text": "SUSE Package Hub 15 SP4",
							"product_id": "SUSE Package Hub 15 SP4"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "openSUSE Leap 15.3",
				"branch": [
					{
						"type": "Product Name",
						"name": "openSUSE Leap 15.3",
						"full_product_name": {
							"text": "openSUSE Leap 15.3",
							"product_id": "openSUSE Leap 15.3",
							"cpe": "cpe:/o:opensuse:leap:15.3"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "openSUSE Leap 15.4",
				"branch": [
					{
						"type": "Product Name",
						"name": "openSUSE Leap 15.4",
						"full_product_name": {
							"text": "openSUSE Leap 15.4",
							"product_id": "openSUSE Leap 15.4",
							"cpe": "cpe:/o:opensuse:leap:15.4"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "openSUSE Tumbleweed",
				"branch": [
					{
						"type": "Product Name",
						"name": "openSUSE Tumbleweed",
						"full_product_name": {
							"text": "openSUSE Tumbleweed",
							"product_id": "openSUSE Tumbleweed",
							"cpe": "cpe:/o:opensuse:tumbleweed"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Version",
				"name": "firejail-0.9.68-3.1",
				"full_product_name": {
					"text": "firejail-0.9.68-3.1",
					"product_id": "firejail-0.9.68-3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "firejail-0.9.70-bp153.2.6.1",
				"full_product_name": {
					"text": "firejail-0.9.70-bp153.2.6.1",
					"product_id": "firejail-0.9.70-bp153.2.6.1"
				}
			},
			{
				"type": "Product Version",
				"name": "firejail-0.9.70-bp154.2.3.1",
				"full_product_name": {
					"text": "firejail-0.9.70-bp154.2.3.1",
					"product_id": "firejail-0.9.70-bp154.2.3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "firejail-bash-completion-0.9.68-3.1",
				"full_product_name": {
					"text": "firejail-bash-completion-0.9.68-3.1",
					"product_id": "firejail-bash-completion-0.9.68-3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "firejail-bash-completion-0.9.70-bp154.2.3.1",
				"full_product_name": {
					"text": "firejail-bash-completion-0.9.70-bp154.2.3.1",
					"product_id": "firejail-bash-completion-0.9.70-bp154.2.3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "firejail-zsh-completion-0.9.68-3.1",
				"full_product_name": {
					"text": "firejail-zsh-completion-0.9.68-3.1",
					"product_id": "firejail-zsh-completion-0.9.68-3.1"
				}
			},
			{
				"type": "Product Version",
				"name": "firejail-zsh-completion-0.9.70-bp154.2.3.1",
				"full_product_name": {
					"text": "firejail-zsh-completion-0.9.70-bp154.2.3.1",
					"product_id": "firejail-zsh-completion-0.9.70-bp154.2.3.1"
				}
			}
		],
		"relationship": [
			{
				"product_reference": "firejail-0.9.70-bp153.2.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Package Hub 15 SP3"
			},
			{
				"product_reference": "firejail-0.9.70-bp154.2.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Package Hub 15 SP4"
			},
			{
				"product_reference": "firejail-bash-completion-0.9.70-bp154.2.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Package Hub 15 SP4"
			},
			{
				"product_reference": "firejail-zsh-completion-0.9.70-bp154.2.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Package Hub 15 SP4"
			},
			{
				"product_reference": "firejail-0.9.70-bp153.2.6.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.3"
			},
			{
				"product_reference": "firejail-0.9.70-bp154.2.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.4"
			},
			{
				"product_reference": "firejail-bash-completion-0.9.70-bp154.2.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.4"
			},
			{
				"product_reference": "firejail-zsh-completion-0.9.70-bp154.2.3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.4"
			},
			{
				"product_reference": "firejail-0.9.68-3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Tumbleweed"
			},
			{
				"product_reference": "firejail-bash-completion-0.9.68-3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Tumbleweed"
			},
			{
				"product_reference": "firejail-zsh-completion-0.9.68-3.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Tumbleweed"
			}
		]
	},
	"vulnerability": [
		{
			"notes": [
				{
					"text": "A Privilege Context Switching issue was discovered in join.c in Firejail 0.9.68. By crafting a bogus Firejail container that is accepted by the Firejail setuid-root program as a join target, a local attacker can enter an environment in which the Linux user namespace is still the initial user namespace, the NO_NEW_PRIVS prctl is not activated, and the entered mount namespace is under the attacker's control. In this way, the filesystem layout can be adjusted to gain root privileges through execution of available setuid-root binaries such as su or sudo.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2022-31214",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1",
						"SUSE Package Hub 15 SP4:firejail-0.9.70-bp154.2.3.1",
						"SUSE Package Hub 15 SP4:firejail-bash-completion-0.9.70-bp154.2.3.1",
						"SUSE Package Hub 15 SP4:firejail-zsh-completion-0.9.70-bp154.2.3.1",
						"openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1",
						"openSUSE Leap 15.4:firejail-0.9.70-bp154.2.3.1",
						"openSUSE Leap 15.4:firejail-bash-completion-0.9.70-bp154.2.3.1",
						"openSUSE Leap 15.4:firejail-zsh-completion-0.9.70-bp154.2.3.1",
						"openSUSE Tumbleweed:firejail-0.9.68-3.1",
						"openSUSE Tumbleweed:firejail-bash-completion-0.9.68-3.1",
						"openSUSE Tumbleweed:firejail-zsh-completion-0.9.68-3.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "important"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {
					"base_score_v_2": "7.2",
					"vector_v_2": "AV:L/AC:L/Au:N/C:C/I:C/A:C"
				},
				"score_set_v_3": {
					"base_score_v_3": "7.8",
					"vector_v_3": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
				}
			}
		}
	]
}
