{
  "document_title": "CVE-2018-12029",
  "document_type": "SUSE CVE",
  "document_publisher": {
    "type": "Vendor",
    "contact_details": "security@suse.de",
    "issuing_authority": "SUSE Security Team"
  },
  "document_tracking": {
    "identification": {
      "id": "SUSE CVE-2018-12029"
    },
    "status": "Interim",
    "version": "1",
    "revision_history": {
      "revision": {
        "number": "12",
        "date": "2022-10-06T00:42:11Z",
        "description": "current"
      }
    },
    "initial_release_date": "2021-05-30T14:13:56Z",
    "current_release_date": "2022-10-06T00:42:11Z",
    "generator": {
      "engine": "cve-database/bin/generate-cvrf-cve.pl",
      "date": "2020-12-27T01:00:00Z"
    }
  },
  "document_notes": [
    {
      "text": "CVE-2018-12029",
      "title": "CVE",
      "type": "Summary"
    },
    {
      "text": "A race condition in the nginx module in Phusion Passenger 3.x through 5.x before 5.3.2 allows local escalation of privileges when a non-standard passenger_instance_registry_dir with insufficiently strict permissions is configured. Replacing a file with a symlink after the file was created, but before it was chowned, leads to the target of the link being chowned via the path. Targeting sensitive files such as root's crontab file allows privilege escalation.",
      "title": "Mitre CVE Description",
      "type": "Description"
    },
    {
      "text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
      "title": "Terms of Use",
      "type": "Legal Disclaimer"
    }
  ],
  "document_references": [
    {
      "type": "Self",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2018-July/004296.html",
      "description": "E-Mail link for SUSE-SU-2018:2039-1"
    },
    {
      "type": "Self",
      "url": "https://www.suse.com/support/security/rating/",
      "description": "SUSE Security Ratings"
    }
  ],
  "product_tree": {
    "branch": [
      {
        "type": "Product Family",
        "name": "SUSE Linux Enterprise High Performance Computing 12",
        "branch": [
          {
            "type": "Product Name",
            "name": "SUSE Linux Enterprise Module for Containers 12",
            "full_product_name": {
              "text": "SUSE Linux Enterprise Module for Containers 12",
              "product_id": "SUSE Linux Enterprise Module for Containers 12",
              "cpe": "cpe:/o:suse:sle-module-containers:12"
            }
          }
        ],
        "full_product_name": {}
      },
      {
        "type": "Product Family",
        "name": "SUSE Linux Enterprise Server 12",
        "branch": [
          {
            "type": "Product Name",
            "name": "SUSE Linux Enterprise Module for Containers 12",
            "full_product_name": {
              "text": "SUSE Linux Enterprise Module for Containers 12",
              "product_id": "SUSE Linux Enterprise Module for Containers 12",
              "cpe": "cpe:/o:suse:sle-module-containers:12"
            }
          }
        ],
        "full_product_name": {}
      },
      {
        "type": "Product Family",
        "name": "SUSE Linux Enterprise Server 12 SP3",
        "branch": [
          {
            "type": "Product Name",
            "name": "SUSE Linux Enterprise Module for Containers 12",
            "full_product_name": {
              "text": "SUSE Linux Enterprise Module for Containers 12",
              "product_id": "SUSE Linux Enterprise Module for Containers 12",
              "cpe": "cpe:/o:suse:sle-module-containers:12"
            }
          }
        ],
        "full_product_name": {}
      },
      {
        "type": "Product Family",
        "name": "SUSE Linux Enterprise Server 12 SP4",
        "branch": [
          {
            "type": "Product Name",
            "name": "SUSE Linux Enterprise Module for Containers 12",
            "full_product_name": {
              "text": "SUSE Linux Enterprise Module for Containers 12",
              "product_id": "SUSE Linux Enterprise Module for Containers 12",
              "cpe": "cpe:/o:suse:sle-module-containers:12"
            }
          }
        ],
        "full_product_name": {}
      },
      {
        "type": "Product Family",
        "name": "SUSE Linux Enterprise Server 12 SP5",
        "branch": [
          {
            "type": "Product Name",
            "name": "SUSE Linux Enterprise Module for Containers 12",
            "full_product_name": {
              "text": "SUSE Linux Enterprise Module for Containers 12",
              "product_id": "SUSE Linux Enterprise Module for Containers 12",
              "cpe": "cpe:/o:suse:sle-module-containers:12"
            }
          }
        ],
        "full_product_name": {}
      },
      {
        "type": "Product Family",
        "name": "SUSE Linux Enterprise Server for SAP Applications 12",
        "branch": [
          {
            "type": "Product Name",
            "name": "SUSE Linux Enterprise Module for Containers 12",
            "full_product_name": {
              "text": "SUSE Linux Enterprise Module for Containers 12",
              "product_id": "SUSE Linux Enterprise Module for Containers 12",
              "cpe": "cpe:/o:suse:sle-module-containers:12"
            }
          }
        ],
        "full_product_name": {}
      },
      {
        "type": "Product Family",
        "name": "SUSE Linux Enterprise Server for SAP Applications 12 SP3",
        "branch": [
          {
            "type": "Product Name",
            "name": "SUSE Linux Enterprise Module for Containers 12",
            "full_product_name": {
              "text": "SUSE Linux Enterprise Module for Containers 12",
              "product_id": "SUSE Linux Enterprise Module for Containers 12",
              "cpe": "cpe:/o:suse:sle-module-containers:12"
            }
          }
        ],
        "full_product_name": {}
      },
      {
        "type": "Product Family",
        "name": "SUSE Linux Enterprise Server for SAP Applications 12 SP4",
        "branch": [
          {
            "type": "Product Name",
            "name": "SUSE Linux Enterprise Module for Containers 12",
            "full_product_name": {
              "text": "SUSE Linux Enterprise Module for Containers 12",
              "product_id": "SUSE Linux Enterprise Module for Containers 12",
              "cpe": "cpe:/o:suse:sle-module-containers:12"
            }
          }
        ],
        "full_product_name": {}
      },
      {
        "type": "Product Family",
        "name": "SUSE Linux Enterprise Server for SAP Applications 12 SP5",
        "branch": [
          {
            "type": "Product Name",
            "name": "SUSE Linux Enterprise Module for Containers 12",
            "full_product_name": {
              "text": "SUSE Linux Enterprise Module for Containers 12",
              "product_id": "SUSE Linux Enterprise Module for Containers 12",
              "cpe": "cpe:/o:suse:sle-module-containers:12"
            }
          }
        ],
        "full_product_name": {}
      },
      {
        "type": "Product Family",
        "name": "openSUSE Tumbleweed",
        "branch": [
          {
            "type": "Product Name",
            "name": "openSUSE Tumbleweed",
            "full_product_name": {
              "text": "openSUSE Tumbleweed",
              "product_id": "openSUSE Tumbleweed",
              "cpe": "cpe:/o:opensuse:tumbleweed"
            }
          }
        ],
        "full_product_name": {}
      },
      {
        "type": "Product Version",
        "name": "ruby2.1-rubygem-passenger-5.0.18-12.9.1",
        "full_product_name": {
          "text": "ruby2.1-rubygem-passenger-5.0.18-12.9.1",
          "product_id": "ruby2.1-rubygem-passenger-5.0.18-12.9.1"
        }
      },
      {
        "type": "Product Version",
        "name": "ruby2.7-rubygem-passenger-6.0.8-3.2",
        "full_product_name": {
          "text": "ruby2.7-rubygem-passenger-6.0.8-3.2",
          "product_id": "ruby2.7-rubygem-passenger-6.0.8-3.2"
        }
      },
      {
        "type": "Product Version",
        "name": "ruby3.0-rubygem-passenger-6.0.8-3.2",
        "full_product_name": {
          "text": "ruby3.0-rubygem-passenger-6.0.8-3.2",
          "product_id": "ruby3.0-rubygem-passenger-6.0.8-3.2"
        }
      },
      {
        "type": "Product Version",
        "name": "rubygem-passenger-5.0.18-12.9.1",
        "full_product_name": {
          "text": "rubygem-passenger-5.0.18-12.9.1",
          "product_id": "rubygem-passenger-5.0.18-12.9.1"
        }
      },
      {
        "type": "Product Version",
        "name": "rubygem-passenger-6.0.8-3.2",
        "full_product_name": {
          "text": "rubygem-passenger-6.0.8-3.2",
          "product_id": "rubygem-passenger-6.0.8-3.2"
        }
      },
      {
        "type": "Product Version",
        "name": "rubygem-passenger-apache2-5.0.18-12.9.1",
        "full_product_name": {
          "text": "rubygem-passenger-apache2-5.0.18-12.9.1",
          "product_id": "rubygem-passenger-apache2-5.0.18-12.9.1"
        }
      },
      {
        "type": "Product Version",
        "name": "rubygem-passenger-apache2-6.0.8-3.2",
        "full_product_name": {
          "text": "rubygem-passenger-apache2-6.0.8-3.2",
          "product_id": "rubygem-passenger-apache2-6.0.8-3.2"
        }
      },
      {
        "type": "Product Version",
        "name": "rubygem-passenger-nginx-6.0.8-3.2",
        "full_product_name": {
          "text": "rubygem-passenger-nginx-6.0.8-3.2",
          "product_id": "rubygem-passenger-nginx-6.0.8-3.2"
        }
      }
    ],
    "relationship": [
      {
        "product_reference": "ruby2.1-rubygem-passenger-5.0.18-12.9.1",
        "relation_type": "Default Component Of",
        "relates_to_product_reference": "SUSE Linux Enterprise Module for Containers 12"
      },
      {
        "product_reference": "rubygem-passenger-5.0.18-12.9.1",
        "relation_type": "Default Component Of",
        "relates_to_product_reference": "SUSE Linux Enterprise Module for Containers 12"
      },
      {
        "product_reference": "rubygem-passenger-apache2-5.0.18-12.9.1",
        "relation_type": "Default Component Of",
        "relates_to_product_reference": "SUSE Linux Enterprise Module for Containers 12"
      },
      {
        "product_reference": "ruby2.7-rubygem-passenger-6.0.8-3.2",
        "relation_type": "Default Component Of",
        "relates_to_product_reference": "openSUSE Tumbleweed"
      },
      {
        "product_reference": "ruby3.0-rubygem-passenger-6.0.8-3.2",
        "relation_type": "Default Component Of",
        "relates_to_product_reference": "openSUSE Tumbleweed"
      },
      {
        "product_reference": "rubygem-passenger-6.0.8-3.2",
        "relation_type": "Default Component Of",
        "relates_to_product_reference": "openSUSE Tumbleweed"
      },
      {
        "product_reference": "rubygem-passenger-apache2-6.0.8-3.2",
        "relation_type": "Default Component Of",
        "relates_to_product_reference": "openSUSE Tumbleweed"
      },
      {
        "product_reference": "rubygem-passenger-nginx-6.0.8-3.2",
        "relation_type": "Default Component Of",
        "relates_to_product_reference": "openSUSE Tumbleweed"
      }
    ]
  },
  "vulnerability": [
    {
      "notes": [
        {
          "text": "A race condition in the nginx module in Phusion Passenger 3.x through 5.x before 5.3.2 allows local escalation of privileges when a non-standard passenger_instance_registry_dir with insufficiently strict permissions is configured. Replacing a file with a symlink after the file was created, but before it was chowned, leads to the target of the link being chowned via the path. Targeting sensitive files such as root's crontab file allows privilege escalation.",
          "title": "Vulnerability Description",
          "type": "General"
        }
      ],
      "cve": "CVE-2018-12029",
      "product_statuses": [
        {
          "type": "Fixed",
          "product_id": [
            "SUSE Linux Enterprise Module for Containers 12:ruby2.1-rubygem-passenger-5.0.18-12.9.1",
            "SUSE Linux Enterprise Module for Containers 12:rubygem-passenger-5.0.18-12.9.1",
            "SUSE Linux Enterprise Module for Containers 12:rubygem-passenger-apache2-5.0.18-12.9.1",
            "openSUSE Tumbleweed:ruby2.7-rubygem-passenger-6.0.8-3.2",
            "openSUSE Tumbleweed:ruby3.0-rubygem-passenger-6.0.8-3.2",
            "openSUSE Tumbleweed:rubygem-passenger-6.0.8-3.2",
            "openSUSE Tumbleweed:rubygem-passenger-apache2-6.0.8-3.2",
            "openSUSE Tumbleweed:rubygem-passenger-nginx-6.0.8-3.2"
          ]
        }
      ],
      "threats": [
        {
          "type": "Impact",
          "description": "moderate"
        }
      ],
      "cvss_score_sets": {
        "score_set_v_2": {
          "base_score_v_2": "4.4",
          "vector_v_2": "AV:L/AC:M/Au:N/C:P/I:P/A:P"
        },
        "score_set_v_3": {
          "base_score_v_3": "8.1",
          "vector_v_3": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H"
        }
      }
    }
  ]
}
