{
	"document_title": "CVE-2024-2698",
	"document_type": "SUSE CVE",
	"document_publisher": {
		"type": "Vendor",
		"contact_details": "security@suse.de",
		"issuing_authority": "SUSE Security Team"
	},
	"document_tracking": {
		"identification": {
			"id": "SUSE CVE-2024-2698"
		},
		"status": "Interim",
		"version": "1",
		"revision_history": {
			"revision": {
				"number": "1",
				"date": "2024-07-03T23:25:48Z",
				"description": "current"
			}
		},
		"initial_release_date": "2024-07-03T23:25:48Z",
		"current_release_date": "2024-07-03T23:25:48Z",
		"generator": {
			"engine": "cve-database/bin/generate-cvrf-cve.pl",
			"date": "2020-12-27T01:00:00Z"
		}
	},
	"document_notes": [
		{
			"text": "CVE-2024-2698",
			"title": "CVE",
			"type": "Summary"
		},
		{
			"text": "A vulnerability was found in FreeIPA in how the initial implementation of MS-SFU by MIT Kerberos was missing a condition for granting the \"forwardable\" flag on S4U2Self tickets. Fixing this mistake required adding a special case for the check_allowed_to_delegate() function: If the target service argument is NULL, then it means the KDC is probing for general constrained delegation rules and not checking a specific S4U2Proxy request.\n\nIn FreeIPA 4.11.0, the behavior of ipadb_match_acl() was modified to match the changes from upstream MIT Kerberos 1.20. However, a mistake resulting in this mechanism applies in cases where the target service argument is set AND where it is unset. This results in S4U2Proxy requests being accepted regardless of whether or not there is a matching service delegation rule.",
			"title": "Mitre CVE Description",
			"type": "Description"
		},
		{
			"text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
			"title": "Terms of Use",
			"type": "Legal Disclaimer"
		}
	],
	"document_references": [
		{
			"type": "Self",
			"url": "https://www.suse.com/support/security/rating/",
			"description": "SUSE Security Ratings"
		}
	],
	"product_tree": {
		"branch": [
			{
				"type": "Product Family",
				"name": "SUSE Liberty Linux 9",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Liberty Linux 9",
						"full_product_name": {
							"text": "SUSE Liberty Linux 9",
							"product_id": "SUSE Liberty Linux 9",
							"cpe": "cpe:/o:suse:sll:9"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Version",
				"name": "ipa-client-4.11.0-15.el9_4",
				"full_product_name": {
					"text": "ipa-client-4.11.0-15.el9_4",
					"product_id": "ipa-client-4.11.0-15.el9_4"
				}
			},
			{
				"type": "Product Version",
				"name": "ipa-client-common-4.11.0-15.el9_4",
				"full_product_name": {
					"text": "ipa-client-common-4.11.0-15.el9_4",
					"product_id": "ipa-client-common-4.11.0-15.el9_4"
				}
			},
			{
				"type": "Product Version",
				"name": "ipa-client-epn-4.11.0-15.el9_4",
				"full_product_name": {
					"text": "ipa-client-epn-4.11.0-15.el9_4",
					"product_id": "ipa-client-epn-4.11.0-15.el9_4"
				}
			},
			{
				"type": "Product Version",
				"name": "ipa-client-samba-4.11.0-15.el9_4",
				"full_product_name": {
					"text": "ipa-client-samba-4.11.0-15.el9_4",
					"product_id": "ipa-client-samba-4.11.0-15.el9_4"
				}
			},
			{
				"type": "Product Version",
				"name": "ipa-common-4.11.0-15.el9_4",
				"full_product_name": {
					"text": "ipa-common-4.11.0-15.el9_4",
					"product_id": "ipa-common-4.11.0-15.el9_4"
				}
			},
			{
				"type": "Product Version",
				"name": "ipa-selinux-4.11.0-15.el9_4",
				"full_product_name": {
					"text": "ipa-selinux-4.11.0-15.el9_4",
					"product_id": "ipa-selinux-4.11.0-15.el9_4"
				}
			},
			{
				"type": "Product Version",
				"name": "ipa-server-4.11.0-15.el9_4",
				"full_product_name": {
					"text": "ipa-server-4.11.0-15.el9_4",
					"product_id": "ipa-server-4.11.0-15.el9_4"
				}
			},
			{
				"type": "Product Version",
				"name": "ipa-server-common-4.11.0-15.el9_4",
				"full_product_name": {
					"text": "ipa-server-common-4.11.0-15.el9_4",
					"product_id": "ipa-server-common-4.11.0-15.el9_4"
				}
			},
			{
				"type": "Product Version",
				"name": "ipa-server-dns-4.11.0-15.el9_4",
				"full_product_name": {
					"text": "ipa-server-dns-4.11.0-15.el9_4",
					"product_id": "ipa-server-dns-4.11.0-15.el9_4"
				}
			},
			{
				"type": "Product Version",
				"name": "ipa-server-trust-ad-4.11.0-15.el9_4",
				"full_product_name": {
					"text": "ipa-server-trust-ad-4.11.0-15.el9_4",
					"product_id": "ipa-server-trust-ad-4.11.0-15.el9_4"
				}
			},
			{
				"type": "Product Version",
				"name": "python3-ipaclient-4.11.0-15.el9_4",
				"full_product_name": {
					"text": "python3-ipaclient-4.11.0-15.el9_4",
					"product_id": "python3-ipaclient-4.11.0-15.el9_4"
				}
			},
			{
				"type": "Product Version",
				"name": "python3-ipalib-4.11.0-15.el9_4",
				"full_product_name": {
					"text": "python3-ipalib-4.11.0-15.el9_4",
					"product_id": "python3-ipalib-4.11.0-15.el9_4"
				}
			},
			{
				"type": "Product Version",
				"name": "python3-ipaserver-4.11.0-15.el9_4",
				"full_product_name": {
					"text": "python3-ipaserver-4.11.0-15.el9_4",
					"product_id": "python3-ipaserver-4.11.0-15.el9_4"
				}
			},
			{
				"type": "Product Version",
				"name": "python3-ipatests-4.11.0-15.el9_4",
				"full_product_name": {
					"text": "python3-ipatests-4.11.0-15.el9_4",
					"product_id": "python3-ipatests-4.11.0-15.el9_4"
				}
			}
		],
		"relationship": [
			{
				"product_reference": "ipa-client-4.11.0-15.el9_4",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Liberty Linux 9"
			},
			{
				"product_reference": "ipa-client-common-4.11.0-15.el9_4",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Liberty Linux 9"
			},
			{
				"product_reference": "ipa-client-epn-4.11.0-15.el9_4",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Liberty Linux 9"
			},
			{
				"product_reference": "ipa-client-samba-4.11.0-15.el9_4",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Liberty Linux 9"
			},
			{
				"product_reference": "ipa-common-4.11.0-15.el9_4",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Liberty Linux 9"
			},
			{
				"product_reference": "ipa-selinux-4.11.0-15.el9_4",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Liberty Linux 9"
			},
			{
				"product_reference": "ipa-server-4.11.0-15.el9_4",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Liberty Linux 9"
			},
			{
				"product_reference": "ipa-server-common-4.11.0-15.el9_4",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Liberty Linux 9"
			},
			{
				"product_reference": "ipa-server-dns-4.11.0-15.el9_4",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Liberty Linux 9"
			},
			{
				"product_reference": "ipa-server-trust-ad-4.11.0-15.el9_4",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Liberty Linux 9"
			},
			{
				"product_reference": "python3-ipaclient-4.11.0-15.el9_4",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Liberty Linux 9"
			},
			{
				"product_reference": "python3-ipalib-4.11.0-15.el9_4",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Liberty Linux 9"
			},
			{
				"product_reference": "python3-ipaserver-4.11.0-15.el9_4",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Liberty Linux 9"
			},
			{
				"product_reference": "python3-ipatests-4.11.0-15.el9_4",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Liberty Linux 9"
			}
		]
	},
	"vulnerability": [
		{
			"notes": [
				{
					"text": "A vulnerability was found in FreeIPA in how the initial implementation of MS-SFU by MIT Kerberos was missing a condition for granting the \"forwardable\" flag on S4U2Self tickets. Fixing this mistake required adding a special case for the check_allowed_to_delegate() function: If the target service argument is NULL, then it means the KDC is probing for general constrained delegation rules and not checking a specific S4U2Proxy request.\n\nIn FreeIPA 4.11.0, the behavior of ipadb_match_acl() was modified to match the changes from upstream MIT Kerberos 1.20. However, a mistake resulting in this mechanism applies in cases where the target service argument is set AND where it is unset. This results in S4U2Proxy requests being accepted regardless of whether or not there is a matching service delegation rule.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2024-2698",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"SUSE Liberty Linux 9:ipa-client-4.11.0-15.el9_4",
						"SUSE Liberty Linux 9:ipa-client-common-4.11.0-15.el9_4",
						"SUSE Liberty Linux 9:ipa-client-epn-4.11.0-15.el9_4",
						"SUSE Liberty Linux 9:ipa-client-samba-4.11.0-15.el9_4",
						"SUSE Liberty Linux 9:ipa-common-4.11.0-15.el9_4",
						"SUSE Liberty Linux 9:ipa-selinux-4.11.0-15.el9_4",
						"SUSE Liberty Linux 9:ipa-server-4.11.0-15.el9_4",
						"SUSE Liberty Linux 9:ipa-server-common-4.11.0-15.el9_4",
						"SUSE Liberty Linux 9:ipa-server-dns-4.11.0-15.el9_4",
						"SUSE Liberty Linux 9:ipa-server-trust-ad-4.11.0-15.el9_4",
						"SUSE Liberty Linux 9:python3-ipaclient-4.11.0-15.el9_4",
						"SUSE Liberty Linux 9:python3-ipalib-4.11.0-15.el9_4",
						"SUSE Liberty Linux 9:python3-ipaserver-4.11.0-15.el9_4",
						"SUSE Liberty Linux 9:python3-ipatests-4.11.0-15.el9_4"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "important"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {},
				"score_set_v_3": {}
			}
		}
	]
}
