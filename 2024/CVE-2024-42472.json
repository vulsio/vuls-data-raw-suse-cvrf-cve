{
	"document_title": "CVE-2024-42472",
	"document_type": "SUSE CVE",
	"document_publisher": {
		"type": "Vendor",
		"contact_details": "security@suse.de",
		"issuing_authority": "SUSE Security Team"
	},
	"document_tracking": {
		"identification": {
			"id": "SUSE CVE-2024-42472"
		},
		"status": "Interim",
		"version": "1",
		"revision_history": {
			"revision": {
				"number": "3",
				"date": "2024-08-16T23:09:41Z",
				"description": "current"
			}
		},
		"initial_release_date": "2024-08-14T23:09:46Z",
		"current_release_date": "2024-08-16T23:09:41Z",
		"generator": {
			"engine": "cve-database/bin/generate-cvrf-cve.pl",
			"date": "2020-12-27T01:00:00Z"
		}
	},
	"document_notes": [
		{
			"text": "CVE-2024-42472",
			"title": "CVE",
			"type": "Summary"
		},
		{
			"text": "Flatpak is a Linux application sandboxing and distribution framework. Prior to versions 1.14.0 and 1.15.10, a malicious or compromised Flatpak app using persistent directories could access and write files outside of what it would otherwise have access to, which is an attack on integrity and confidentiality.\n\nWhen `persistent=subdir` is used in the application permissions (represented as `--persist=subdir` in the command-line interface), that means that an application which otherwise doesn't have access to the real user home directory will see an empty home directory with a writeable subdirectory `subdir`. Behind the scenes, this directory is actually a bind mount and the data is stored in the per-application directory as `~/.var/app/$APPID/subdir`. This allows existing apps that are not aware of the per-application directory to still work as intended without general home directory access.\n\nHowever, the application does have write access to the application directory `~/.var/app/$APPID` where this directory is stored. If the source directory for the `persistent`/`--persist` option is replaced by a symlink, then the next time the application is started, the bind mount will follow the symlink and mount whatever it points to into the sandbox.\n\nPartial protection against this vulnerability can be provided by patching Flatpak using the patches in commits ceec2ffc and 98f79773. However, this leaves a race condition that could be exploited by two instances of a malicious app running in parallel. Closing the race condition requires updating or patching the version of bubblewrap that is used by Flatpak to add the new `--bind-fd` option using the patch and then patching Flatpak to use it. If Flatpak has been configured at build-time with `-Dsystem_bubblewrap=bwrap` (1.15.x) or `--with-system-bubblewrap=bwrap` (1.14.x or older), or a similar option, then the version of bubblewrap that needs to be patched is a system copy that is distributed separately, typically `/usr/bin/bwrap`. This configuration is the one that is typically used in Linux distributions. If Flatpak has been configured at build-time with `-Dsystem_bubblewrap=` (1.15.x) or with `--without-system-bubblewrap` (1.14.x or older), then it is the bundled version of bubblewrap that is included with Flatpak that must be patched. This is typically installed as `/usr/libexec/flatpak-bwrap`. This configuration is the default when building from source code.\n\nFor the 1.14.x stable branch, these changes are included in Flatpak 1.14.10. The bundled version of bubblewrap included in this release has been updated to 0.6.3. For the 1.15.x development branch, these changes are included in Flatpak 1.15.10. The bundled version of bubblewrap in this release is a Meson \"wrap\" subproject, which has been updated to 0.10.0. The 1.12.x and 1.10.x branches will not be updated for this vulnerability. Long-term support OS distributions should backport the individual changes into their versions of Flatpak and bubblewrap, or update to newer versions if their stability policy allows it. As a workaround, avoid using applications using the `persistent` (`--persist`) permission.",
			"title": "Mitre CVE Description",
			"type": "Description"
		},
		{
			"text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
			"title": "Terms of Use",
			"type": "Legal Disclaimer"
		}
	],
	"document_references": [
		{
			"type": "Self",
			"url": "https://www.suse.com/support/security/rating/",
			"description": "SUSE Security Ratings"
		}
	],
	"product_tree": {
		"branch": [
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Desktop 15 SP5",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Module for Desktop Applications 15 SP5",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Module for Desktop Applications 15 SP5",
							"product_id": "SUSE Linux Enterprise Module for Desktop Applications 15 SP5",
							"cpe": "cpe:/o:suse:sle-module-desktop-applications:15:sp5"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Desktop 15 SP6",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Module for Desktop Applications 15 SP6",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Module for Desktop Applications 15 SP6",
							"product_id": "SUSE Linux Enterprise Module for Desktop Applications 15 SP6",
							"cpe": "cpe:/o:suse:sle-module-desktop-applications:15:sp6"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise High Performance Computing 12 SP5",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise High Performance Computing 12 SP5",
						"full_product_name": {
							"text": "SUSE Linux Enterprise High Performance Computing 12 SP5",
							"product_id": "SUSE Linux Enterprise High Performance Computing 12 SP5",
							"cpe": "cpe:/o:suse:sle-hpc:12:sp5"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise High Performance Computing 15 SP2-LTSS",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise High Performance Computing 15 SP2-LTSS",
						"full_product_name": {
							"text": "SUSE Linux Enterprise High Performance Computing 15 SP2-LTSS",
							"product_id": "SUSE Linux Enterprise High Performance Computing 15 SP2-LTSS",
							"cpe": "cpe:/o:suse:sle_hpc-ltss:15:sp2"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise High Performance Computing 15 SP3-LTSS",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise High Performance Computing 15 SP3-LTSS",
						"full_product_name": {
							"text": "SUSE Linux Enterprise High Performance Computing 15 SP3-LTSS",
							"product_id": "SUSE Linux Enterprise High Performance Computing 15 SP3-LTSS",
							"cpe": "cpe:/o:suse:sle_hpc-ltss:15:sp3"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise High Performance Computing 15 SP4-ESPOS",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise High Performance Computing 15 SP4-ESPOS",
						"full_product_name": {
							"text": "SUSE Linux Enterprise High Performance Computing 15 SP4-ESPOS",
							"product_id": "SUSE Linux Enterprise High Performance Computing 15 SP4-ESPOS",
							"cpe": "cpe:/o:suse:sle_hpc-espos:15:sp4"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise High Performance Computing 15 SP4-LTSS",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise High Performance Computing 15 SP4-LTSS",
						"full_product_name": {
							"text": "SUSE Linux Enterprise High Performance Computing 15 SP4-LTSS",
							"product_id": "SUSE Linux Enterprise High Performance Computing 15 SP4-LTSS",
							"cpe": "cpe:/o:suse:sle_hpc-ltss:15:sp4"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise High Performance Computing 15 SP5",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Module for Desktop Applications 15 SP5",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Module for Desktop Applications 15 SP5",
							"product_id": "SUSE Linux Enterprise Module for Desktop Applications 15 SP5",
							"cpe": "cpe:/o:suse:sle-module-desktop-applications:15:sp5"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise High Performance Computing 15 SP6",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Module for Desktop Applications 15 SP6",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Module for Desktop Applications 15 SP6",
							"product_id": "SUSE Linux Enterprise Module for Desktop Applications 15 SP6",
							"cpe": "cpe:/o:suse:sle-module-desktop-applications:15:sp6"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server 12 SP5",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Server 12 SP5",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Server 12 SP5",
							"product_id": "SUSE Linux Enterprise Server 12 SP5",
							"cpe": "cpe:/o:suse:sles:12:sp5"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server 15 SP1-LTSS",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Server 15 SP1-LTSS",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Server 15 SP1-LTSS",
							"product_id": "SUSE Linux Enterprise Server 15 SP1-LTSS",
							"cpe": "cpe:/o:suse:sles-ltss:15:sp1"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server 15 SP2-LTSS",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Server 15 SP2-LTSS",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Server 15 SP2-LTSS",
							"product_id": "SUSE Linux Enterprise Server 15 SP2-LTSS",
							"cpe": "cpe:/o:suse:sles-ltss:15:sp2"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server 15 SP3-LTSS",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Server 15 SP3-LTSS",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Server 15 SP3-LTSS",
							"product_id": "SUSE Linux Enterprise Server 15 SP3-LTSS",
							"cpe": "cpe:/o:suse:sles-ltss:15:sp3"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server 15 SP4-LTSS",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Server 15 SP4-LTSS",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Server 15 SP4-LTSS",
							"product_id": "SUSE Linux Enterprise Server 15 SP4-LTSS",
							"cpe": "cpe:/o:suse:sles-ltss:15:sp4"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server 15 SP5",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Module for Desktop Applications 15 SP5",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Module for Desktop Applications 15 SP5",
							"product_id": "SUSE Linux Enterprise Module for Desktop Applications 15 SP5",
							"cpe": "cpe:/o:suse:sle-module-desktop-applications:15:sp5"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server 15 SP6",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Module for Desktop Applications 15 SP6",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Module for Desktop Applications 15 SP6",
							"product_id": "SUSE Linux Enterprise Module for Desktop Applications 15 SP6",
							"cpe": "cpe:/o:suse:sle-module-desktop-applications:15:sp6"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server 15-LTSS",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Server 15-LTSS",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Server 15-LTSS",
							"product_id": "SUSE Linux Enterprise Server 15-LTSS",
							"cpe": "cpe:/o:suse:sles-ltss:15"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server Teradata 15 SP4",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Server Teradata 15 SP4",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Server Teradata 15 SP4",
							"product_id": "SUSE Linux Enterprise Server Teradata 15 SP4",
							"cpe": "cpe:/o:suse:sles_teradata:15:sp4"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server for SAP Applications 12 SP5",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Server for SAP Applications 12 SP5",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Server for SAP Applications 12 SP5",
							"product_id": "SUSE Linux Enterprise Server for SAP Applications 12 SP5",
							"cpe": "cpe:/o:suse:sles_sap:12:sp5"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server for SAP Applications 15 SP2",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Server for SAP Applications 15 SP2",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Server for SAP Applications 15 SP2",
							"product_id": "SUSE Linux Enterprise Server for SAP Applications 15 SP2",
							"cpe": "cpe:/o:suse:sles_sap:15:sp2"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server for SAP Applications 15 SP3",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Server for SAP Applications 15 SP3",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Server for SAP Applications 15 SP3",
							"product_id": "SUSE Linux Enterprise Server for SAP Applications 15 SP3",
							"cpe": "cpe:/o:suse:sles_sap:15:sp3"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server for SAP Applications 15 SP4",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Server for SAP Applications 15 SP4",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Server for SAP Applications 15 SP4",
							"product_id": "SUSE Linux Enterprise Server for SAP Applications 15 SP4",
							"cpe": "cpe:/o:suse:sles_sap:15:sp4"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server for SAP Applications 15 SP5",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Module for Desktop Applications 15 SP5",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Module for Desktop Applications 15 SP5",
							"product_id": "SUSE Linux Enterprise Module for Desktop Applications 15 SP5",
							"cpe": "cpe:/o:suse:sle-module-desktop-applications:15:sp5"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "SUSE Linux Enterprise Server for SAP Applications 15 SP6",
				"branch": [
					{
						"type": "Product Name",
						"name": "SUSE Linux Enterprise Module for Desktop Applications 15 SP6",
						"full_product_name": {
							"text": "SUSE Linux Enterprise Module for Desktop Applications 15 SP6",
							"product_id": "SUSE Linux Enterprise Module for Desktop Applications 15 SP6",
							"cpe": "cpe:/o:suse:sle-module-desktop-applications:15:sp6"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "openSUSE Leap 15.5",
				"branch": [
					{
						"type": "Product Name",
						"name": "openSUSE Leap 15.5",
						"full_product_name": {
							"text": "openSUSE Leap 15.5",
							"product_id": "openSUSE Leap 15.5",
							"cpe": "cpe:/o:opensuse:leap:15.5"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "openSUSE Leap 15.6",
				"branch": [
					{
						"type": "Product Name",
						"name": "openSUSE Leap 15.6",
						"full_product_name": {
							"text": "openSUSE Leap 15.6",
							"product_id": "openSUSE Leap 15.6",
							"cpe": "cpe:/o:opensuse:leap:15.6"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Family",
				"name": "openSUSE Tumbleweed",
				"branch": [
					{
						"type": "Product Name",
						"name": "openSUSE Tumbleweed",
						"full_product_name": {
							"text": "openSUSE Tumbleweed",
							"product_id": "openSUSE Tumbleweed",
							"cpe": "cpe:/o:opensuse:tumbleweed"
						}
					}
				],
				"full_product_name": {}
			},
			{
				"type": "Product Version",
				"name": "bubblewrap-0.10.0-1.1",
				"full_product_name": {
					"text": "bubblewrap-0.10.0-1.1",
					"product_id": "bubblewrap-0.10.0-1.1"
				}
			},
			{
				"type": "Product Version",
				"name": "bubblewrap-zsh-completion-0.10.0-1.1",
				"full_product_name": {
					"text": "bubblewrap-zsh-completion-0.10.0-1.1",
					"product_id": "bubblewrap-zsh-completion-0.10.0-1.1"
				}
			},
			{
				"type": "Product Version",
				"name": "flatpak",
				"full_product_name": {
					"text": "flatpak",
					"product_id": "flatpak"
				}
			},
			{
				"type": "Product Version",
				"name": "flatpak-devel",
				"full_product_name": {
					"text": "flatpak-devel",
					"product_id": "flatpak-devel"
				}
			},
			{
				"type": "Product Version",
				"name": "flatpak-remote-flathub",
				"full_product_name": {
					"text": "flatpak-remote-flathub",
					"product_id": "flatpak-remote-flathub"
				}
			},
			{
				"type": "Product Version",
				"name": "flatpak-zsh-completion",
				"full_product_name": {
					"text": "flatpak-zsh-completion",
					"product_id": "flatpak-zsh-completion"
				}
			},
			{
				"type": "Product Version",
				"name": "libflatpak0",
				"full_product_name": {
					"text": "libflatpak0",
					"product_id": "libflatpak0"
				}
			},
			{
				"type": "Product Version",
				"name": "system-user-flatpak",
				"full_product_name": {
					"text": "system-user-flatpak",
					"product_id": "system-user-flatpak"
				}
			},
			{
				"type": "Product Version",
				"name": "typelib-1_0-Flatpak-1_0",
				"full_product_name": {
					"text": "typelib-1_0-Flatpak-1_0",
					"product_id": "typelib-1_0-Flatpak-1_0"
				}
			}
		],
		"relationship": [
			{
				"product_reference": "bubblewrap-0.10.0-1.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Tumbleweed"
			},
			{
				"product_reference": "bubblewrap-zsh-completion-0.10.0-1.1",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Tumbleweed"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 12 SP5"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP2-LTSS"
			},
			{
				"product_reference": "flatpak-devel",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP2-LTSS"
			},
			{
				"product_reference": "flatpak-zsh-completion",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP2-LTSS"
			},
			{
				"product_reference": "libflatpak0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP2-LTSS"
			},
			{
				"product_reference": "system-user-flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP2-LTSS"
			},
			{
				"product_reference": "typelib-1_0-Flatpak-1_0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP2-LTSS"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP3-LTSS"
			},
			{
				"product_reference": "flatpak-devel",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP3-LTSS"
			},
			{
				"product_reference": "flatpak-zsh-completion",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP3-LTSS"
			},
			{
				"product_reference": "libflatpak0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP3-LTSS"
			},
			{
				"product_reference": "system-user-flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP3-LTSS"
			},
			{
				"product_reference": "typelib-1_0-Flatpak-1_0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP3-LTSS"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP4-ESPOS"
			},
			{
				"product_reference": "flatpak-devel",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP4-ESPOS"
			},
			{
				"product_reference": "flatpak-zsh-completion",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP4-ESPOS"
			},
			{
				"product_reference": "libflatpak0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP4-ESPOS"
			},
			{
				"product_reference": "system-user-flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP4-ESPOS"
			},
			{
				"product_reference": "typelib-1_0-Flatpak-1_0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP4-ESPOS"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP4-LTSS"
			},
			{
				"product_reference": "flatpak-devel",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP4-LTSS"
			},
			{
				"product_reference": "flatpak-zsh-completion",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP4-LTSS"
			},
			{
				"product_reference": "libflatpak0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP4-LTSS"
			},
			{
				"product_reference": "system-user-flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP4-LTSS"
			},
			{
				"product_reference": "typelib-1_0-Flatpak-1_0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise High Performance Computing 15 SP4-LTSS"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for Desktop Applications 15 SP5"
			},
			{
				"product_reference": "flatpak-devel",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for Desktop Applications 15 SP5"
			},
			{
				"product_reference": "flatpak-remote-flathub",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for Desktop Applications 15 SP5"
			},
			{
				"product_reference": "flatpak-zsh-completion",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for Desktop Applications 15 SP5"
			},
			{
				"product_reference": "libflatpak0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for Desktop Applications 15 SP5"
			},
			{
				"product_reference": "system-user-flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for Desktop Applications 15 SP5"
			},
			{
				"product_reference": "typelib-1_0-Flatpak-1_0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for Desktop Applications 15 SP5"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for Desktop Applications 15 SP6"
			},
			{
				"product_reference": "flatpak-devel",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for Desktop Applications 15 SP6"
			},
			{
				"product_reference": "flatpak-remote-flathub",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for Desktop Applications 15 SP6"
			},
			{
				"product_reference": "flatpak-zsh-completion",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for Desktop Applications 15 SP6"
			},
			{
				"product_reference": "libflatpak0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for Desktop Applications 15 SP6"
			},
			{
				"product_reference": "system-user-flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for Desktop Applications 15 SP6"
			},
			{
				"product_reference": "typelib-1_0-Flatpak-1_0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Module for Desktop Applications 15 SP6"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 12 SP5"
			},
			{
				"product_reference": "libflatpak0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 12 SP5"
			},
			{
				"product_reference": "typelib-1_0-Flatpak-1_0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 12 SP5"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP1-LTSS"
			},
			{
				"product_reference": "flatpak-devel",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP1-LTSS"
			},
			{
				"product_reference": "flatpak-zsh-completion",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP1-LTSS"
			},
			{
				"product_reference": "libflatpak0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP1-LTSS"
			},
			{
				"product_reference": "typelib-1_0-Flatpak-1_0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP1-LTSS"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP2-LTSS"
			},
			{
				"product_reference": "flatpak-devel",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP2-LTSS"
			},
			{
				"product_reference": "flatpak-zsh-completion",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP2-LTSS"
			},
			{
				"product_reference": "libflatpak0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP2-LTSS"
			},
			{
				"product_reference": "system-user-flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP2-LTSS"
			},
			{
				"product_reference": "typelib-1_0-Flatpak-1_0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP2-LTSS"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP3-LTSS"
			},
			{
				"product_reference": "flatpak-devel",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP3-LTSS"
			},
			{
				"product_reference": "flatpak-zsh-completion",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP3-LTSS"
			},
			{
				"product_reference": "libflatpak0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP3-LTSS"
			},
			{
				"product_reference": "system-user-flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP3-LTSS"
			},
			{
				"product_reference": "typelib-1_0-Flatpak-1_0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP3-LTSS"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP4-LTSS"
			},
			{
				"product_reference": "flatpak-devel",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP4-LTSS"
			},
			{
				"product_reference": "flatpak-zsh-completion",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP4-LTSS"
			},
			{
				"product_reference": "libflatpak0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP4-LTSS"
			},
			{
				"product_reference": "system-user-flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP4-LTSS"
			},
			{
				"product_reference": "typelib-1_0-Flatpak-1_0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15 SP4-LTSS"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15-LTSS"
			},
			{
				"product_reference": "flatpak-devel",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15-LTSS"
			},
			{
				"product_reference": "libflatpak0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15-LTSS"
			},
			{
				"product_reference": "typelib-1_0-Flatpak-1_0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server 15-LTSS"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server Teradata 15 SP4"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 12 SP5"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP2"
			},
			{
				"product_reference": "flatpak-devel",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP2"
			},
			{
				"product_reference": "flatpak-zsh-completion",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP2"
			},
			{
				"product_reference": "libflatpak0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP2"
			},
			{
				"product_reference": "system-user-flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP2"
			},
			{
				"product_reference": "typelib-1_0-Flatpak-1_0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP2"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP3"
			},
			{
				"product_reference": "flatpak-devel",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP3"
			},
			{
				"product_reference": "flatpak-zsh-completion",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP3"
			},
			{
				"product_reference": "libflatpak0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP3"
			},
			{
				"product_reference": "system-user-flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP3"
			},
			{
				"product_reference": "typelib-1_0-Flatpak-1_0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP3"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP4"
			},
			{
				"product_reference": "flatpak-devel",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP4"
			},
			{
				"product_reference": "flatpak-zsh-completion",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP4"
			},
			{
				"product_reference": "libflatpak0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP4"
			},
			{
				"product_reference": "system-user-flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP4"
			},
			{
				"product_reference": "typelib-1_0-Flatpak-1_0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "SUSE Linux Enterprise Server for SAP Applications 15 SP4"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.5"
			},
			{
				"product_reference": "flatpak-devel",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.5"
			},
			{
				"product_reference": "flatpak-remote-flathub",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.5"
			},
			{
				"product_reference": "flatpak-zsh-completion",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.5"
			},
			{
				"product_reference": "libflatpak0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.5"
			},
			{
				"product_reference": "system-user-flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.5"
			},
			{
				"product_reference": "typelib-1_0-Flatpak-1_0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.5"
			},
			{
				"product_reference": "flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.6"
			},
			{
				"product_reference": "flatpak-devel",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.6"
			},
			{
				"product_reference": "flatpak-remote-flathub",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.6"
			},
			{
				"product_reference": "flatpak-zsh-completion",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.6"
			},
			{
				"product_reference": "libflatpak0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.6"
			},
			{
				"product_reference": "system-user-flatpak",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.6"
			},
			{
				"product_reference": "typelib-1_0-Flatpak-1_0",
				"relation_type": "Default Component Of",
				"relates_to_product_reference": "openSUSE Leap 15.6"
			}
		]
	},
	"vulnerability": [
		{
			"notes": [
				{
					"text": "Flatpak is a Linux application sandboxing and distribution framework. Prior to versions 1.14.0 and 1.15.10, a malicious or compromised Flatpak app using persistent directories could access and write files outside of what it would otherwise have access to, which is an attack on integrity and confidentiality.\n\nWhen `persistent=subdir` is used in the application permissions (represented as `--persist=subdir` in the command-line interface), that means that an application which otherwise doesn't have access to the real user home directory will see an empty home directory with a writeable subdirectory `subdir`. Behind the scenes, this directory is actually a bind mount and the data is stored in the per-application directory as `~/.var/app/$APPID/subdir`. This allows existing apps that are not aware of the per-application directory to still work as intended without general home directory access.\n\nHowever, the application does have write access to the application directory `~/.var/app/$APPID` where this directory is stored. If the source directory for the `persistent`/`--persist` option is replaced by a symlink, then the next time the application is started, the bind mount will follow the symlink and mount whatever it points to into the sandbox.\n\nPartial protection against this vulnerability can be provided by patching Flatpak using the patches in commits ceec2ffc and 98f79773. However, this leaves a race condition that could be exploited by two instances of a malicious app running in parallel. Closing the race condition requires updating or patching the version of bubblewrap that is used by Flatpak to add the new `--bind-fd` option using the patch and then patching Flatpak to use it. If Flatpak has been configured at build-time with `-Dsystem_bubblewrap=bwrap` (1.15.x) or `--with-system-bubblewrap=bwrap` (1.14.x or older), or a similar option, then the version of bubblewrap that needs to be patched is a system copy that is distributed separately, typically `/usr/bin/bwrap`. This configuration is the one that is typically used in Linux distributions. If Flatpak has been configured at build-time with `-Dsystem_bubblewrap=` (1.15.x) or with `--without-system-bubblewrap` (1.14.x or older), then it is the bundled version of bubblewrap that is included with Flatpak that must be patched. This is typically installed as `/usr/libexec/flatpak-bwrap`. This configuration is the default when building from source code.\n\nFor the 1.14.x stable branch, these changes are included in Flatpak 1.14.10. The bundled version of bubblewrap included in this release has been updated to 0.6.3. For the 1.15.x development branch, these changes are included in Flatpak 1.15.10. The bundled version of bubblewrap in this release is a Meson \"wrap\" subproject, which has been updated to 0.10.0. The 1.12.x and 1.10.x branches will not be updated for this vulnerability. Long-term support OS distributions should backport the individual changes into their versions of Flatpak and bubblewrap, or update to newer versions if their stability policy allows it. As a workaround, avoid using applications using the `persistent` (`--persist`) permission.",
					"title": "Vulnerability Description",
					"type": "General"
				}
			],
			"cve": "CVE-2024-42472",
			"product_statuses": [
				{
					"type": "Fixed",
					"product_id": [
						"openSUSE Tumbleweed:bubblewrap-0.10.0-1.1",
						"openSUSE Tumbleweed:bubblewrap-zsh-completion-0.10.0-1.1"
					]
				}
			],
			"threats": [
				{
					"type": "Impact",
					"description": "critical"
				}
			],
			"cvss_score_sets": {
				"score_set_v_2": {},
				"score_set_v_3": {
					"base_score_v_3": "8.4",
					"vector_v_3": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N"
				}
			}
		}
	]
}
